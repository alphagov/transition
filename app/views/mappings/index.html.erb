<% content_for(:page_title, "Mappings for #{@site.abbr}") %>

<h1>Mappings</h1>

<%= render partial: 'site', locals: { site: @site } %>

<%= render partial: 'filters' %>

<% if @mappings.empty? %>
    <p>
      No mappings found.
      <%= link_to 'Remove filter', site_mappings_path(@site) if params[:contains] %>
    </p>
<% else %>
    <table class="mappings table table-bordered">
      <thead>
      <tr>
        <th></th>
        <th>HTTP Status</th>
        <th>Original path</th>
        <th>New URL</th>
      </tr>
      </thead>
      <tbody>
      <% @mappings.each do |mapping| %>
          <tr data-status-code="<%= mapping.http_status %>">
            <td><%= link_to 'Edit', edit_site_mapping_path(@site, mapping) %></td>
            <td><%= mapping.http_status %></td>
            <td><%= link_to mapping.path, 'http://'+ @site.default_host.hostname + mapping.path %></td>
            <td><%= link_to mapping.new_url, mapping.new_url if mapping.new_url.present? %></td>
          </tr>
      <% end %>
      </tbody>
    </table>
    <%= paginate(@mappings) %>
<% end %>


